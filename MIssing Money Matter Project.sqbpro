<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Users/Josh3/OneDrive/Desktop/Data/SQL/Ex_Files_SQL_EssT/Exercise Files/WSDA_Music.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="3930"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,8:mainEmployee"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Album" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="1" mode="0"/></sort><column_widths><column index="1" value="61"/><column index="2" value="219"/><column index="3" value="59"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Artist" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="2" mode="0"/></sort><column_widths><column index="1" value="74"/><column index="2" value="187"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Customer" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="1" mode="1"/></sort><column_widths><column index="1" value="109"/><column index="2" value="95"/><column index="3" value="105"/><column index="4" value="300"/><column index="5" value="300"/><column index="6" value="167"/><column index="7" value="54"/><column index="8" value="124"/><column index="9" value="104"/><column index="10" value="165"/><column index="11" value="157"/><column index="12" value="233"/><column index="13" value="129"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Employee" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="82"/><column index="2" value="71"/><column index="3" value="71"/><column index="4" value="124"/><column index="5" value="75"/><column index="6" value="129"/><column index="7" value="129"/><column index="8" value="178"/><column index="9" value="67"/><column index="10" value="44"/><column index="11" value="60"/><column index="12" value="80"/><column index="13" value="115"/><column index="14" value="115"/><column index="15" value="168"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Genre" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="78"/><column index="2" value="144"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Invoice" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="91"/><column index="2" value="109"/><column index="3" value="162"/><column index="4" value="300"/><column index="5" value="167"/><column index="6" value="107"/><column index="7" value="130"/><column index="8" value="158"/><column index="9" value="66"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="InvoiceLine" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="94"/><column index="2" value="68"/><column index="3" value="56"/><column index="4" value="65"/><column index="5" value="64"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="PlaylistTrack" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="89"/><column index="2" value="73"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Track" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort><column index="9" mode="0"/></sort><column_widths><column index="1" value="73"/><column index="2" value="187"/><column index="3" value="82"/><column index="4" value="119"/><column index="5" value="78"/><column index="6" value="244"/><column index="7" value="113"/><column index="8" value="97"/><column index="9" value="86"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="V_AvgTotal" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="470"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="V_Tracks_invoiceLine" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="91"/><column index="2" value="86"/><column index="3" value="82"/><column index="4" value="171"/><column index="5" value="262"/><column index="6" value="113"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="Challenge 1">/*
Created by: Josh Liao
Create date: 3/27/23
Description: Project Missing Money Matter Challenge 1
Q1. How many transactions between years 2011-2012?
Q2. How much money did WSDA music make during same period?
*/

--1.
SELECT
Count()
InvoiceDate
FROM
Invoice
WHERE
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31'

--2.
SELECT 
Sum(Total)
FROM
Invoice
WHERE
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31'</sql><sql name="Challenge 2">/*
Created by: Josh Liao
Create date: 3/27/23
Description: Project Missing Money Matter Challenge 2
Q1. Get list of cusomters who made purchases between 2011 and 2012
Q2. Get list of customers, sales reps and total transaction amounts for each customer between 2011 and 2012
Q3. How many transactions are above the average transaction amount during the same time period?
Q4. What is average transaction amount for each year that WDSA music has been in business?
*/

--1.
SELECT
c.FirstName,
c.LastName,
i.total
FROM
Invoice i
INNER JOIN
Customer c
ON i.CustomerId = c.CustomerId
WHERE
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31'
ORDER BY
i.total DESC

--2.
SELECT
c.FirstName AS [Customer First Name],
c.LastName AS [Customer Last Name],
e.FirstName AS [Employee First Name],
e.LastName AS [Employee Last Name],
i.total
FROM
Invoice i
INNER JOIN
Customer c
ON i.CustomerId = c.CustomerId
INNER JOIN
Employee e
ON
e.EmployeeId = c.SupportRepId
WHERE
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31'
ORDER BY
i.total DESC

--3.
--Average transaction amount between 2011 and 2012
SELECT
round(avg(total),2) AS [Average Transaction Amount]
FROM
Invoice
WHERE
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31'

--Number of transactions over average transaction amount
SELECT
Count(total) AS [Number of Transactions Over Average]
FROM 
Invoice
WHERE 
total&gt;
(SELECT
round(avg(total),2) AS [Average Transaction Amount]
FROM
Invoice
WHERE
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31')
AND 
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31'

--4.
SELECT
round(avg(total),2) AS [Average Transaction Amount],
strftime('%Y', InvoiceDate) AS [Year]
FROM
Invoice
GROUP BY
strftime('%Y', InvoiceDate)



</sql><sql name="Challenge 3">/*
Created by: Josh Liao
Create date: 3/27/23
Description: Project Missing Money Matter Challenge 3
Q1. Get list of employees who exceeded the average transaction amount from sales they generated during 2011 and 2012
Q2. Create a commission payout column that displays each employee's commission based 15% of the sales transaction amount
Q3. Which employee made the highest commission?
Q4. List customers that highest comission employee supported
Q5. Which customer made highest purchase?
Q6. What is suspicious?
Q7. Who do you conclude it our primary person of interest?
*/

--Q1.
SELECT
e.FirstName,
e.LastName,
sum(i.total) AS [Total Sales]
FROM 
Invoice i
INNER JOIN
Customer c
ON i.CustomerId = c.CustomerId
INNER JOIN
Employee e
ON e.EmployeeId = c.SupportRepId
WHERE
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31'
AND 
i.total &gt; 11.66
GROUP BY
e.FirstName,
e.LastName
ORDER BY
e.LastName

--Q2. 
SELECT 
e.FirstName,
e.LastName,
sum(i.total) AS [Total Sales],
sum(i.total)*0.15 AS [Commission Payout]
FROM
Invoice i
INNER JOIN
Customer c
ON i.CustomerId = c.CustomerId
INNER JOIN
Employee e
ON e.EmployeeId = c.SupportRepId
WHERE
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31'
GROUP BY
e.FirstName,
e.LastName
ORDER BY
e.LastName

--Q3.
--Highest commission employee is Jane Peacock

--Q4.
SELECT 
c.FirstName AS [Customer FirstName],
c.LastName AS [Customer LastName],
e.FirstName AS [Employee FirstName],
e.LastName AS [Employee LastName],
sum(i.total) AS [Total Sales],
sum(i.total)*0.15 AS [Commission Payout]
FROM
Invoice i
INNER JOIN
Customer c
ON i.CustomerId = c.CustomerId
INNER JOIN
Employee e
ON e.EmployeeId = c.SupportRepId
WHERE
InvoiceDate &gt;= '2011-01-01' AND InvoiceDate &lt;= '2012-12-31'
AND
SupportRepId = 3
GROUP BY
c.FirstName,
c.LastName,
e.FirstName,
e.LastName
ORDER BY
[Total Sales] DESC

--Q5
--John Doeein made largest purchase

--Q6
SELECT 
*
FROM 
Customer c
WHERE
c.LastName = 'Doeein'

--Q7
--Person of interest is Jane Peacock who appears to have created fake client, John Doeein</sql><current_tab id="0"/></tab_sql></sqlb_project>
